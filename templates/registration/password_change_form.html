{% extends "base.html" %}
{% block content %}
<div class="v-container">
    <div class="v-form-card" style="max-width: 500px; margin: 40px auto;">
        <h2 class="v-section-title" style="text-align: center; margin-bottom: 32px;">Change Password</h2>
        <form method="post">
            {% csrf_token %}
            <div class="v-form-fields">
                {% for field in form %}
                <div class="v-form-group">
                    <label class="v-label" for="{{ field.id_for_label }}">{{ field.label }}</label>
                    <div style="position: relative;">
                        {{ field }}
                        {% if 'password' in field.name.lower or 'pwd' in field.name.lower %}
                        <button type="button" onclick="togglePasswordVisibility('{{ field.id_for_label }}')"
                            style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; color: var(--text-secondary); padding: 8px;">
                            <i class="fas fa-eye"></i>
                        </button>
                        {% endif %}
                    </div>
                    {% if field.errors %}
                    {% for error in field.errors %}
                    <small style="color: var(--danger); display: block; margin-top: 4px; font-weight: 600;">{{ error
                        }}</small>
                    {% endfor %}
                    {% endif %}
                </div>
                {% endfor %}
            </div>
            <button type="submit" class="v-btn v-btn-primary"
                style="width: 100%; height: 48px; margin-top: 24px;">Update Password</button>
        </form>
    </div>
</div>

<script>
    function togglePasswordVisibility(fieldId) {
        const field = document.getElementById(fieldId);
        const icon = event.currentTarget.querySelector('i');
        if (field.type === 'password') {
            field.type = 'text';
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
        } else {
            field.type = 'password';
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
        }
    }
</script>

<style>
    input {
        width: 100%;
        padding: 12px 16px;
        border: 1.5px solid var(--border-color);
        border-radius: 12px;
        background: var(--input-bg);
        color: var(--text-primary);
        font-family: inherit;
        font-size: 15px;
        transition: all 0.2s;
    }

    input:focus {
        outline: none;
        border-color: var(--accent-color);
        background: var(--input-focus-bg);
        box-shadow: 0 0 0 4px rgba(91, 95, 199, 0.1);
    }
</style>
{% endblock %}